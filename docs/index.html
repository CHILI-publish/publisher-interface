<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@chili-publish/publisher-interface</title><meta name="description" content="Documentation for @chili-publish/publisher-interface"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@chili-publish/publisher-interface</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>@chili-publish/publisher-interface </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#publisher-interface" id="publisher-interface" style="color: inherit; text-decoration: none;">
  <h1>Publisher Interface</h1>
</a>
<p>PublisherInterface is a class object that allows you to interact with the CHILI Editor editorObject via <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">postMessage</a> without
the complexity of postMessage.</p>
<p>Why choose this over interacting with the editorObject directly?</p>
<ul>
<li>The first and most obvious reason is CORS - by using PublisherInterface you do not have to worry about reverse proxy tricks, which are are not officially supported.</li>
<li>The documentation of each function of PublisherInterface (really the editorObject) is the most complete documentation in existence.</li>
<li>Works with CHILI publisher Online.</li>
<li>Promise based and modern.</li>
</ul>
<br/>


<a href="#note" id="note" style="color: inherit; text-decoration: none;">
  <h4>Note:</h4>
</a>
<p><em>As of version 0.3, the project name was changed from PublisherConnector to PublisherInterface to avoid confusion with future connector plugins.</em></p>
<br/>


<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
  <h2>Installation</h2>
</a>
<p>You can install PublisherInterface via npm</p>
<p><code>npm i @chili-publish/publisher-interface</code></p>
<p>or through yarn</p>
<p><code>yarn add @chili-publish/publisher-interface</code></p>

<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
  <h2>Usage</h2>
</a>
<ol>
<li>Import PublisherInterface.</li>
</ol>
<p>If you downloaded the library:</p>
<pre><code class="language-javascript"><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">PublisherInterface</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@chili-publish/publisher-interface&quot;</span><span class="hl-1">;</span>
</code></pre>
<p>or using in the web via unpkg URL:</p>
<pre><code class="language-javascript"><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">PublisherInterface</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;https://unpkg.com/@chili-publish/publisher-interface@latest/dist/PublisherInterface.min.js&quot;</span><span class="hl-1">;</span>
</code></pre>
<br/>
2. Get the HTMLIFrameElement which contains the CHILI Editor.

<pre><code class="language-javascript"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">iframe</span><span class="hl-1"> = </span><span class="hl-2">document</span><span class="hl-1">.</span><span class="hl-6">getElementById</span><span class="hl-1">(</span><span class="hl-3">&quot;editor-iframe&quot;</span><span class="hl-1">);</span>
</code></pre>
<br/>
3. Create an instance of PublisherInterface by using the `build` method and passing the HTMLIFrameElement (created above)
   as a parameter. The `build` method returns a promise, which when resolved has the instance of the PublisherInterface.

<pre><code class="language-javascript"><span class="hl-2">PublisherInterface</span><span class="hl-1">.</span><span class="hl-6">build</span><span class="hl-1">(</span><span class="hl-2">iframe</span><span class="hl-1">).</span><span class="hl-6">then</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">PublisherInterface</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">PublisherInterface</span><span class="hl-1">.</span><span class="hl-6">alert</span><span class="hl-1">(</span><span class="hl-3">&quot;Hi!&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">);</span>
</code></pre>
<br/>


<a href="#üö®Ô∏è-important-üõë" id="üö®Ô∏è-important-üõë" style="color: inherit; text-decoration: none;">
  <h3>üö®Ô∏è IMPORTANT üõë</h3>
</a>
<p>The PublisherInterface <code>build</code> method must be called before the IFrame loads the Editor. This is due to
how <a href="https://github.com/Aaronius/penpal">Penpal</a>, the library the PublisherInterface is built on, functions.</p>
<p>If you set the <code>src</code> attribute of the IFrame in your HTML and have a script tag that runs the build method, then
everything will be fine. The issue is only if you were to wait until IFrame was loaded before calling the <code>build</code>
method.</p>
<p>For example the below code will work because the <code>build</code> method is called before the IFrame is loaded.</p>
<pre><code class="language-html"><span class="hl-7">&lt;</span><span class="hl-8">body</span><span class="hl-7">&gt;</span><br/><span class="hl-1">    </span><span class="hl-7">&lt;</span><span class="hl-8">iframe</span><span class="hl-1"> </span><span class="hl-9">id</span><span class="hl-1">=</span><span class="hl-10">&quot;editor-iframe&quot;</span><span class="hl-1"> </span><span class="hl-9">style</span><span class="hl-1">=</span><span class="hl-10">&quot;width:1200px; height:800px&quot;</span><br/><span class="hl-1">        </span><span class="hl-9">src</span><span class="hl-1">=</span><span class="hl-10">&quot;https://example.chili-publish.online/example/editor_html.aspx?doc=3d178228-a9b9-49d0-90d9-c1c8f8b67f05&amp;apiKey=Sczs1ruhiZcaFiqg0G07gMFMq07X+SG2o8KlW8oAeZGvqoB1a0YvkbeZU1wJK15aIhANgZmhg+13NQlxpBEq7Q==&quot;</span><span class="hl-7">&gt;&lt;/</span><span class="hl-8">iframe</span><span class="hl-7">&gt;</span><br/><span class="hl-1">    </span><span class="hl-7">&lt;</span><span class="hl-8">script</span><span class="hl-11"> </span><span class="hl-9">type</span><span class="hl-11">=</span><span class="hl-10">&quot;module&quot;</span><span class="hl-7">&gt;</span><br/><span class="hl-11">        </span><span class="hl-0">import</span><span class="hl-11"> {</span><span class="hl-2">PublisherInterface</span><span class="hl-11">} </span><span class="hl-0">from</span><span class="hl-11"> </span><span class="hl-3">&#39;https://unpkg.com/@chili-publish/publisher-interface@latest/dist/PublisherInterface.min.js&#39;</span><span class="hl-11">;</span><br/><span class="hl-11">    </span><br/><span class="hl-11">        </span><span class="hl-4">const</span><span class="hl-11"> </span><span class="hl-5">iframe</span><span class="hl-11"> </span><span class="hl-1">=</span><span class="hl-11"> </span><span class="hl-2">document</span><span class="hl-11">.</span><span class="hl-6">getElementById</span><span class="hl-11">(</span><span class="hl-3">&quot;editor-iframe&quot;</span><span class="hl-11">);</span><br/><span class="hl-11">    </span><br/><span class="hl-11">        (</span><span class="hl-4">async</span><span class="hl-11"> () </span><span class="hl-4">=&gt;</span><span class="hl-11"> {</span><br/><span class="hl-11">            </span><span class="hl-4">const</span><span class="hl-11"> </span><span class="hl-5">PublisherInterface</span><span class="hl-11"> </span><span class="hl-1">=</span><span class="hl-11"> </span><span class="hl-0">await</span><span class="hl-11"> </span><span class="hl-2">PublisherInterface</span><span class="hl-11">.</span><span class="hl-6">build</span><span class="hl-11">(</span><span class="hl-2">iframe</span><span class="hl-11">);</span><br/><span class="hl-11">            </span><span class="hl-4">const</span><span class="hl-11"> </span><span class="hl-5">documentName</span><span class="hl-11"> </span><span class="hl-1">=</span><span class="hl-11"> </span><span class="hl-0">await</span><span class="hl-11"> </span><span class="hl-2">PublisherInterface</span><span class="hl-11">.</span><span class="hl-6">getObject</span><span class="hl-11">(</span><span class="hl-3">&quot;document.name&quot;</span><span class="hl-11">);</span><br/><span class="hl-11">            </span><span class="hl-2">console</span><span class="hl-11">.</span><span class="hl-6">log</span><span class="hl-11">(</span><span class="hl-2">documentName</span><span class="hl-11">);</span><br/><span class="hl-11">        })();</span><br/><span class="hl-11">    </span><span class="hl-7">&lt;/</span><span class="hl-8">script</span><span class="hl-7">&gt;</span><br/><span class="hl-7">&lt;/</span><span class="hl-8">body</span><span class="hl-7">&gt;</span>
</code></pre>

<a href="#api-reference" id="api-reference" style="color: inherit; text-decoration: none;">
  <h2>API Reference</h2>
</a>
<ul>
<li><a href="/docs/index.html">PublisherInterface</a></li>
</ul>

<a href="#differences-with-editorobject" id="differences-with-editorobject" style="color: inherit; text-decoration: none;">
  <h2>Differences with <code>editorObject</code></h2>
</a>
<p>The PublisherInterface class and editorObject object share many similarities. This is not odd as the PublisherInterface is an
interface for interacting with the editorObject via postMessage. Below will mark any key differences.</p>

<a href="#naming" id="naming" style="color: inherit; text-decoration: none;">
  <h3>Naming</h3>
</a>
<p>A small, but important difference is that the methods from the PublisherInterface uses common JavaScript naming - camel
case. This differs from the Pascal case used by the editorObject.</p>
<p>So <code>editorObject.GetObject</code> becomes <code>PublisherInterface.getObject</code>.</p>
<p>So <code>editorObject.SetProperty</code> becomes <code>PublisherInterface.setProperty</code>.
<br/>
<br/></p>

<a href="#promise-return" id="promise-return" style="color: inherit; text-decoration: none;">
  <h3>Promise Return</h3>
</a>
<p>While the editorObject methods return without delay, the PublisherInterface uses postMessage. This means that the message
must be serialized, sent, deserialized across from one window to another.</p>
<p>To make this easy, the PublisherInterface methods return a Promise.</p>
<p>So instead of:</p>
<pre><code class="language-javascript"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">documentId</span><span class="hl-1"> = </span><span class="hl-2">editorObject</span><span class="hl-1">.</span><span class="hl-6">GetObject</span><span class="hl-1">(</span><span class="hl-3">&quot;document.id&quot;</span><span class="hl-1">);</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">documentId</span><span class="hl-1">);</span>
</code></pre>
<p>You would do:</p>
<pre><code class="language-javascript"><span class="hl-2">PublisherInterface</span><span class="hl-1">.</span><span class="hl-6">getObject</span><span class="hl-1">(</span><span class="hl-3">&quot;document.id&quot;</span><span class="hl-1">).</span><span class="hl-6">then</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">documentId</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">documentId</span><span class="hl-1">)</span><br/><span class="hl-1">);</span>
</code></pre>
<p>or use <code>await</code>, in a function marked <code>async</code>:</p>
<pre><code class="language-javascript"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">documentId</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">PublisherInterface</span><span class="hl-1">.</span><span class="hl-6">getObject</span><span class="hl-1">(</span><span class="hl-3">&quot;document.id&quot;</span><span class="hl-1">);</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">documentId</span><span class="hl-1">);</span>
</code></pre>
<p>Just like editorObject methods, if something goes wrong, an error will be thrown.
<br/>
<br/></p>

<a href="#events" id="events" style="color: inherit; text-decoration: none;">
  <h3>Events</h3>
</a>
<p>The PublisherInterface does events completely different from what is documented for the editorObject.</p>
<p>To use events with the editorObject, it involved called the <code>editorObject.AddListener</code> method and then defining a
function on <code>window.OnEditorEvent</code> that took a string for events. The OnEditorEvent function would typically have a
switch case or a series of if/else to determine which event was called.</p>
<p>PublisherInterface makes things much simpler. If you want to listen to an event and then do something, then name it and add
a callback function.</p>
<pre><code class="language-javascript"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">PublisherInterface</span><span class="hl-1">.</span><span class="hl-6">addListener</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-3">&quot;FrameMoveFinished&quot;</span><span class="hl-1">, </span><br/><span class="hl-1">  </span><span class="hl-2">target</span><span class="hl-1"> </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;Frame moved with id &quot;</span><span class="hl-1"> + </span><span class="hl-2">target</span><span class="hl-1">)</span><br/><span class="hl-1">);</span>
</code></pre>
<p>Removing an event is pretty much the same.</p>
<pre><code class="language-javascript"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">PublisherInterface</span><span class="hl-1">.</span><span class="hl-6">removeListener</span><span class="hl-1">(</span><span class="hl-3">&quot;FrameMoveFinished&quot;</span><span class="hl-1">);</span>
</code></pre>
<br/>


<a href="#getting-publisherinterface" id="getting-publisherinterface" style="color: inherit; text-decoration: none;">
  <h3>Getting PublisherInterface</h3>
</a>
<p>When not using postMessage, there were two common methods to get the editorObject.</p>
<ul>
<li>Editor page would allow you to set a callback using GetEditor on the IFrame contentWindow to get the editorObject</li>
<li>DocumentFullyLoaded event was called by default, so you could wait until that event was fired and sent to
window.OnEventEvent to get the editorObject directly from the IFrame contentWindow</li>
</ul>
<p>Neither of these methods are possible now, and you will need to use the <code>build</code> method on PublisherInterface. See Usage
above.
<br/></p>

<a href="#limitations" id="limitations" style="color: inherit; text-decoration: none;">
  <h2>Limitations</h2>
</a>
<p>PublisherInterface is built on <a href="https://github.com/Aaronius/penpal">Penpal</a>, which means that it inherits all same
limitations.</p>

<a href="#browser-support" id="browser-support" style="color: inherit; text-decoration: none;">
  <h3>Browser Support</h3>
</a>
<p>PublisherInterface runs successfully on the most recent versions of Chrome, Firefox, Safari, and Edge. Internet Explorer is
not supported.</p>

<a href="#errors" id="errors" style="color: inherit; text-decoration: none;">
  <h3>Errors</h3>
</a>
<p>See <a href="https://github.com/Aaronius/penpal#errors">Penpal Errors</a></p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/PublisherInterface.html" class="tsd-kind-icon">Publisher<wbr/>Interface</a></li><li class="tsd-kind-type-alias"><a href="modules.html#EditorObjectAlias" class="tsd-kind-icon">Editor<wbr/>Object<wbr/>Alias</a></li><li class="tsd-kind-type-alias"><a href="modules.html#buildOptions" class="tsd-kind-icon">build<wbr/>Options</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>